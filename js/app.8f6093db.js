(function(){"use strict";var t={3156:function(t,a,e){var r=e(5130),s=e(6768);const o={id:"app"};function n(t,a,e,r,n,l){const i=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.CE)("div",o,[(0,s.bF)(i)])}var l={name:"App"},i=e(1241);const c=(0,i.A)(l,[["render",n]]);var u=c,d=e(1387),p=e(4232),h=e.p+"img/Logo_Dash2.a2f8b3bb.jpg";const v={class:"app-wrapper"},g={key:0,class:"help-overlay"},k={class:"help-popup"},C={class:"file-upload-section"},D={key:0},m={key:1,class:"error-message"},b={key:2,class:"table-description"},y={class:"widgets-container"},f={class:"kpi-section"},L={class:"data-card"},F={class:"data-card"},E={class:"data-card"},w={class:"data-card"},O={class:"data-card"},_={class:"graphs-section"},S={class:"data-card"},R={key:0,class:"graph-description"},X={class:"data-card"},N={key:0,class:"graph-description"},P={class:"data-card"},B={key:0,class:"graph-description"},A={class:"data-card"},x={key:0,class:"graph-description"},W={class:"tables-section"},j={class:"data-card full-width"},T={key:0,class:"table-description"},M={key:1,class:"transaction-table-wrapper"},K={class:"data-card full-width"},I={key:0,class:"table-description"},H={key:1,class:"top-products-table-wrapper"};function q(t,a,e,r,o,n){const l=(0,s.g2)("LineChart"),i=(0,s.g2)("BarChart"),c=(0,s.g2)("DoughnutChart");return(0,s.uX)(),(0,s.CE)("div",v,[(0,s.Lk)("header",null,[a[3]||(a[3]=(0,s.Lk)("div",{class:"logo-div"},[(0,s.Lk)("img",{src:h,alt:"Logo",class:"logo-dash"}),(0,s.Lk)("h1",null,"Dashboard")],-1)),(0,s.Lk)("button",{onClick:a[0]||(a[0]=(...t)=>r.toggleHelp&&r.toggleHelp(...t)),class:"button-question"},"?")]),r.showHelp?((0,s.uX)(),(0,s.CE)("div",g,[(0,s.Lk)("div",k,[a[4]||(a[4]=(0,s.Fv)("<h3>Как пользоваться дашбордом:</h3><p> Добро пожаловать в дашборд продаж! Здесь вы можете отслеживать ключевые показатели эффективности. </p><ul><li><strong>Последние транзакции:</strong> Просматривайте 10 последних продаж.</li><li><strong>KPI:</strong> Общая выручка, количество заказов, средний чек и прибыль.</li><li><strong>Топ-продукты:</strong> Узнайте, какие товары приносят наибольший доход.</li><li><strong>Динамика выручки:</strong> Отслеживайте изменения выручки по месяцам.</li><li><strong>Продажи по категориям:</strong> Анализируйте вклад различных категорий товаров.</li><li><strong>Распределение клиентов:</strong> Посмотрите сегментацию вашей клиентской базы.</li></ul><p> Для начала работы загрузите файл CSV, нажав на кнопку &quot;Загрузите данные&quot;. </p>",4)),(0,s.Lk)("button",{onClick:a[1]||(a[1]=(...t)=>r.toggleHelp&&r.toggleHelp(...t)),class:"close-popup-button"},"Закрыть")])])):(0,s.Q3)("",!0),a[20]||(a[20]=(0,s.Lk)("div",{class:"file-upload-section"},null,-1)),(0,s.Lk)("div",C,[a[5]||(a[5]=(0,s.Lk)("h3",null,"Загрузите данные для дашборда:",-1)),(0,s.Lk)("input",{type:"file",onChange:a[2]||(a[2]=(...t)=>r.handleFileUpload&&r.handleFileUpload(...t)),accept:".csv"},null,32),a[6]||(a[6]=(0,s.eW)()),r.loading?((0,s.uX)(),(0,s.CE)("p",D,"Загрузка данных...")):(0,s.Q3)("",!0),r.error?((0,s.uX)(),(0,s.CE)("p",m,(0,p.v_)(r.error),1)):(0,s.Q3)("",!0),r.dataStore.rawData.length||r.loading||r.error?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("p",b," Загрузите файл CSV (Excel XLSX не реализована) для отображения данных. "))]),a[21]||(a[21]=(0,s.Lk)("div",{class:"dashboard-title-bar"}," ОСНОВНАЯ АНАЛИТИКА ",-1)),(0,s.Lk)("div",y,[(0,s.Lk)("div",f,[(0,s.Lk)("div",L,[a[7]||(a[7]=(0,s.Lk)("h3",null,"Общая выручка",-1)),(0,s.Lk)("p",null,(0,p.v_)(r.dataStore.processedData.totalRevenue),1)]),(0,s.Lk)("div",F,[a[8]||(a[8]=(0,s.Lk)("h3",null,"Количество заказов",-1)),(0,s.Lk)("p",null,(0,p.v_)(r.dataStore.processedData.totalOrders),1)]),(0,s.Lk)("div",E,[a[9]||(a[9]=(0,s.Lk)("h3",null,"Средний чек",-1)),(0,s.Lk)("p",null,(0,p.v_)(r.dataStore.processedData.averageCheck),1)]),(0,s.Lk)("div",w,[a[10]||(a[10]=(0,s.Lk)("h3",null,"Общая прибыль",-1)),(0,s.Lk)("p",null,(0,p.v_)(r.dataStore.processedData.totalProfit),1)]),(0,s.Lk)("div",O,[a[11]||(a[11]=(0,s.Lk)("h3",null,"Количество проданных единиц",-1)),(0,s.Lk)("p",null,(0,p.v_)(r.dataStore.processedData.unitsSold),1)])]),(0,s.Lk)("div",_,[(0,s.Lk)("div",S,[a[12]||(a[12]=(0,s.Lk)("h3",null,"Динамика выручки",-1)),0===r.revenueChartData.labels.length?((0,s.uX)(),(0,s.CE)("p",R,"Загрузите данные для отображения графика.")):((0,s.uX)(),(0,s.Wv)(l,{key:1,"chart-data":r.revenueChartData,"chart-options":r.revenueChartOptions},null,8,["chart-data","chart-options"]))]),(0,s.Lk)("div",X,[a[13]||(a[13]=(0,s.Lk)("h3",null,"Продажи по категориям",-1)),r.categoryChartData.labels&&0!==r.categoryChartData.labels.length?((0,s.uX)(),(0,s.Wv)(i,{key:1,"chart-data":r.categoryChartData,"chart-options":r.categoryChartOptions},null,8,["chart-data","chart-options"])):((0,s.uX)(),(0,s.CE)("p",N,"Загрузите данные для отображения графика."))]),(0,s.Lk)("div",P,[a[14]||(a[14]=(0,s.Lk)("h3",null,"Средний чек по времени",-1)),r.avgCheckChartData.labels&&0!==r.avgCheckChartData.labels.length?((0,s.uX)(),(0,s.Wv)(l,{key:1,"chart-data":r.avgCheckChartData,"chart-options":r.avgCheckChartOptions},null,8,["chart-data","chart-options"])):((0,s.uX)(),(0,s.CE)("p",B,"Загрузите данные для отображения графика."))]),(0,s.Lk)("div",A,[a[15]||(a[15]=(0,s.Lk)("h3",null,"Распределение клиентов",-1)),r.customerDistributionChartData.labels&&0!==r.customerDistributionChartData.labels.length?((0,s.uX)(),(0,s.Wv)(c,{key:1,"chart-data":r.customerDistributionChartData,"chart-options":r.customerDistributionChartOptions},null,8,["chart-data","chart-options"])):((0,s.uX)(),(0,s.CE)("p",x,"Загрузите данные для отображения графика."))])]),(0,s.Lk)("div",W,[(0,s.Lk)("div",j,[a[17]||(a[17]=(0,s.Lk)("h3",null,"Последние транзакции",-1)),r.dataStore.rawData.length?((0,s.uX)(),(0,s.CE)("div",M,[(0,s.Lk)("table",null,[a[16]||(a[16]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"Дата"),(0,s.Lk)("th",null,"Продукт"),(0,s.Lk)("th",null,"Категория"),(0,s.Lk)("th",null,"Выручка"),(0,s.Lk)("th",null,"Сегмент клиента")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.dataStore.getRawTransactions,((t,a)=>((0,s.uX)(),(0,s.CE)("tr",{key:a},[(0,s.Lk)("td",null,(0,p.v_)(t.Date),1),(0,s.Lk)("td",null,(0,p.v_)(t.Product),1),(0,s.Lk)("td",null,(0,p.v_)(t.Category),1),(0,s.Lk)("td",null,(0,p.v_)(parseFloat(t.Revenue).toFixed(2)),1),(0,s.Lk)("td",null,(0,p.v_)(t.CustomerSegment),1)])))),128))])])])):((0,s.uX)(),(0,s.CE)("p",T,"Загрузите данные, чтобы увидеть последние транзакции."))]),(0,s.Lk)("div",K,[a[19]||(a[19]=(0,s.Lk)("h3",null,"Топ 5 продуктов по выручке",-1)),r.dataStore.processedData.topProducts?.length?((0,s.uX)(),(0,s.CE)("div",H,[(0,s.Lk)("table",null,[a[18]||(a[18]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"Продукт"),(0,s.Lk)("th",null,"Выручка"),(0,s.Lk)("th",null,"Продано единиц")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.dataStore.getTop5Products,((t,a)=>((0,s.uX)(),(0,s.CE)("tr",{key:a},[(0,s.Lk)("td",null,(0,p.v_)(t.name),1),(0,s.Lk)("td",null,(0,p.v_)(parseFloat(t.revenue).toFixed(2)),1),(0,s.Lk)("td",null,(0,p.v_)(t.units),1)])))),128))])])])):((0,s.uX)(),(0,s.CE)("p",I,"Загрузите данные, чтобы увидеть топ продуктов."))])])])])}e(8111),e(1701),e(7588);var $=e(2261);const U=(0,$.nY)("data",{state:()=>({rawData:[],processedData:{totalRevenue:"0",totalOrders:"0",averageCheck:"0",totalProfit:"0",unitsSold:"0",topProducts:[],revenueByMonth:[],salesByCategory:[],averageCheckByTime:[],customerSegmentCounts:[]}}),getters:{getKpiData:t=>t.processedData,getRawTransactions:t=>t.rawData.slice(-10),getTop5Products:t=>t.processedData.topProducts.slice(0,5)},actions:{setRawData(t){this.rawData=t,this.processData()},processData(){if(0===this.rawData.length)return void(this.processedData={totalRevenue:"0",totalOrders:"0",averageCheck:"0",totalProfit:"0",unitsSold:"0",topProducts:[],revenueByMonth:[],salesByCategory:[],averageCheckByTime:[],customerSegmentCounts:[]});let t=0,a=0,e=0,r=0;const s=new Map,o=new Map,n=new Map,l=new Map;this.rawData.forEach((i=>{const c=parseFloat(i.Revenue),u=parseInt(i.UnitsSold||"1"),d=parseFloat(i.Cost),p=isNaN(c)||isNaN(d)?0:c-d;isNaN(c)||(t+=c,a++),isNaN(u)||(e+=u),isNaN(p)||(r+=p);const h=i.Product;if(h){const t=s.get(h)||{revenue:0,units:0};t.revenue+=isNaN(c)?0:c,t.units+=isNaN(u)?0:u,s.set(h,t)}const v=new Date(i.Date);if(!isNaN(v.getTime())&&!isNaN(c)){const t=v.getFullYear(),a=v.getMonth(),e=new Date(t,a,1).toLocaleString("ru-RU",{month:"short",year:"2-digit"}),r=o.get(e)||{totalRevenue:0,totalOrders:0};r.totalRevenue+=c,r.totalOrders+=1,o.set(e,r)}const g=i.Category;g&&!isNaN(c)&&n.set(g,(n.get(g)||0)+c);const k=i.CustomerSegment;k&&l.set(k,(l.get(k)||0)+1)}));const i=a>0?(t/a).toFixed(2):"0";this.processedData.totalRevenue=t.toFixed(2),this.processedData.totalOrders=a.toString(),this.processedData.averageCheck=i,this.processedData.unitsSold=e.toString(),this.processedData.totalProfit=r.toFixed(2);const c=Array.from(s.entries()).map((([t,a])=>({name:t,revenue:a.revenue,units:a.units}))).sort(((t,a)=>a.revenue-t.revenue));this.processedData.topProducts=c;const u=Array.from(o.keys()).sort(((t,a)=>{const e=t=>{const[a,e]=t.split(" "),r=parseInt(`20${e}`),s={"янв":0,"фев":1,"мар":2,"апр":3,"май":4,"июнь":5,"июль":6,"авг":7,"сен":8,"окт":9,"ноя":10,"дек":11,"мая":4,"янв.":0,"февр.":1,"март":2,"апр.":3,"июня":5,"июля":6,"авг.":7,"сент.":8,"окт.":9,"нояб.":10,"дек.":11};let o=s[a.toLowerCase()];return void 0===o?(console.warn(`Не удалось распознать месяц: "${a}" из строки "${t}".`),new Date(NaN)):new Date(r,o)};return e(t)-e(a)}));this.processedData.revenueByMonth=u.map((t=>({month:t,value:parseFloat(o.get(t).totalRevenue.toFixed(2))}))),this.processedData.averageCheckByTime=u.map((t=>{const a=o.get(t),e=a.totalOrders>0?a.totalRevenue/a.totalOrders:0;return{time:t,value:parseFloat(e.toFixed(2))}})),this.processedData.salesByCategory=Array.from(n.entries()).map((([t,a])=>({category:t,value:parseFloat(a.toFixed(2))}))),this.processedData.customerSegmentCounts=Array.from(l.entries()).map((([t,a])=>({segment:t,count:a})))},resetData(){this.rawData=[],this.processData()}}});var Q=e(144),V=e(8344),Y=e.n(V),Z=e(1010),z=e(9064);const G={class:"chart-container"};var J={__name:"LineCharts",props:{chartData:{type:Object,required:!0},chartOptions:{type:Object,default:()=>({responsive:!0,maintainAspectRatio:!1})}},setup(t){return z.t1.register(z.hE,z.m_,z.s$,z.No,z.PP,z.kc,z.FN),(a,e)=>((0,s.uX)(),(0,s.CE)("div",G,[(0,s.bF)((0,Q.R1)(Z.N1),{data:t.chartData,options:t.chartOptions},null,8,["data","options"])]))}};const tt=(0,i.A)(J,[["__scopeId","data-v-b340b380"]]);var at=tt;const et={class:"chart-container"};var rt={__name:"BarCharts",props:{chartData:{type:Object,required:!0},chartOptions:{type:Object,default:()=>({responsive:!0,maintainAspectRatio:!1})}},setup(t){return z.t1.register(z.hE,z.m_,z.s$,z.E8,z.PP,z.kc),(a,e)=>((0,s.uX)(),(0,s.CE)("div",et,[(0,s.bF)((0,Q.R1)(Z.yP),{data:t.chartData,options:t.chartOptions},null,8,["data","options"])]))}};const st=(0,i.A)(rt,[["__scopeId","data-v-77711da7"]]);var ot=st;const nt={class:"chart-container"};var lt={__name:"DoughnutCharts",props:{chartData:{type:Object,required:!0},chartOptions:{type:Object,default:()=>({responsive:!0,maintainAspectRatio:!1})}},setup(t){return z.t1.register(z.hE,z.m_,z.s$,z.Bs),(a,e)=>((0,s.uX)(),(0,s.CE)("div",nt,[(0,s.bF)((0,Q.R1)(Z.nu),{data:t.chartData,options:t.chartOptions},null,8,["data","options"])]))}};const it=(0,i.A)(lt,[["__scopeId","data-v-f4c9fac4"]]);var ct=it,ut={name:"DashboardOverview",components:{LineChart:at,BarChart:ot,DoughnutChart:ct},setup(){const t=U(),a=(0,Q.KR)(!1),e=(0,Q.KR)(null),r=(0,Q.KR)(!1),o=()=>{r.value=!r.value},n=async r=>{const s=r.target.files[0];if(s){if(a.value=!0,e.value=null,!s.name.endsWith(".csv"))return e.value="Пожалуйста, загрузите файл формата CSV.",a.value=!1,void t.resetData();try{const r=await s.text();Y().parse(r,{header:!0,skipEmptyLines:!0,dynamicTyping:!0,complete:r=>{r.errors.length?(console.error("PapaParse errors:",r.errors),e.value="Ошибка при парсинге CSV: "+r.errors[0].message,t.resetData()):t.setRawData(r.data),a.value=!1},error:r=>{e.value="Ошибка при чтении файла: "+r.message,a.value=!1,t.resetData()}})}catch(o){e.value="Непредвиденная ошибка при обработке файла: "+o.message,console.error(o),a.value=!1,t.resetData()}}else t.resetData()},l=(0,s.EW)((()=>{const a=t.processedData.revenueByMonth;return a&&0!==a.length?{labels:a.map((t=>t.month)),datasets:[{label:"Выручка",backgroundColor:"rgba(248, 121, 121, 0.5)",borderColor:"#f87979",data:a.map((t=>t.value)),fill:!0}]}:{labels:[],datasets:[]}})),i=(0,s.EW)((()=>({responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!0}}}))),c=(0,s.EW)((()=>{const a=t.processedData.salesByCategory;if(!a||0===a.length)return{labels:[],datasets:[]};const e=a.map((t=>t.category)),r=a.map((t=>t.value)),s=["#FF6384","#36A2EB","#FFCE56","#4BC0C0","#9966FF","#FF9900","#0099FF","#CC00CC","#66CC66","#FFD700"];return{labels:e,datasets:[{label:"Продажи",backgroundColor:s.slice(0,e.length),data:r}]}})),u=(0,s.EW)((()=>({responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!0},legend:{display:!1}},scales:{y:{beginAtZero:!0}}}))),d=(0,s.EW)((()=>{const a=t.processedData.averageCheckByTime;return a&&0!==a.length?{labels:a.map((t=>t.time)),datasets:[{label:"Средний чек",backgroundColor:"rgba(153, 204, 102, 0.5)",borderColor:"#99CC66",data:a.map((t=>t.value)),fill:!0}]}:{labels:[],datasets:[]}})),p=(0,s.EW)((()=>({responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!0}}}))),h=(0,s.EW)((()=>{const a=t.processedData.customerSegmentCounts;if(!a||0===a.length)return{labels:[],datasets:[]};const e=a.map((t=>t.segment)),r=a.map((t=>t.count)),s=["#FFCD56","#4BC0C0","#FF6384","#36A2EB","#9966FF","#FF9900","#0099FF","#CC00CC"];return{labels:e,datasets:[{backgroundColor:s.slice(0,e.length),data:r}]}})),v=(0,s.EW)((()=>({responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!0}}})));return t.resetData(),{dataStore:t,handleFileUpload:n,loading:a,error:e,showHelp:r,toggleHelp:o,revenueChartData:l,revenueChartOptions:i,categoryChartData:c,categoryChartOptions:u,avgCheckChartData:d,avgCheckChartOptions:p,customerDistributionChartData:h,customerDistributionChartOptions:v}}};const dt=(0,i.A)(ut,[["render",q]]);var pt=dt;const ht=[{path:"/",name:"DashboardOverview",component:pt}],vt=(0,d.aE)({history:(0,d.LA)("/KPDash_for_Small_Business/"),routes:ht});var gt=vt;const kt=(0,r.Ef)(u),Ct=(0,$.Ey)();kt.use(gt),kt.use(Ct),kt.mount("#app")}},a={};function e(r){var s=a[r];if(void 0!==s)return s.exports;var o=a[r]={exports:{}};return t[r].call(o.exports,o,o.exports,e),o.exports}e.m=t,function(){var t=[];e.O=function(a,r,s,o){if(!r){var n=1/0;for(u=0;u<t.length;u++){r=t[u][0],s=t[u][1],o=t[u][2];for(var l=!0,i=0;i<r.length;i++)(!1&o||n>=o)&&Object.keys(e.O).every((function(t){return e.O[t](r[i])}))?r.splice(i--,1):(l=!1,o<n&&(n=o));if(l){t.splice(u--,1);var c=s();void 0!==c&&(a=c)}}return a}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[r,s,o]}}(),function(){e.n=function(t){var a=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(a,{a:a}),a}}(),function(){e.d=function(t,a){for(var r in a)e.o(a,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:a[r]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)}}(),function(){e.p="/KPDash_for_Small_Business/"}(),function(){var t={524:0};e.O.j=function(a){return 0===t[a]};var a=function(a,r){var s,o,n=r[0],l=r[1],i=r[2],c=0;if(n.some((function(a){return 0!==t[a]}))){for(s in l)e.o(l,s)&&(e.m[s]=l[s]);if(i)var u=i(e)}for(a&&a(r);c<n.length;c++)o=n[c],e.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return e.O(u)},r=self["webpackChunkkpi_dashboard"]=self["webpackChunkkpi_dashboard"]||[];r.forEach(a.bind(null,0)),r.push=a.bind(null,r.push.bind(r))}();var r=e.O(void 0,[504],(function(){return e(3156)}));r=e.O(r)})();
//# sourceMappingURL=app.8f6093db.js.map